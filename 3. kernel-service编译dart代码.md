# kernel-service 编译 dart 代码

> kernel-service: 是将 dart 代码编译成 kernel IR (中间表示) 的后台服务. 源代码位置在 sdk/pkg/vm/bin/kernel_service.dart. dart jit 后端只能运行 kernel IR, kernel IR 保存的文件一般以 dill 作为后缀.

## 开启 DFE 的 verbose (输出详细信息) 模式
```bash
dart -DDFE_VERBOSE=true test/hello.dart
```

## 生成和导出 kernel 文件
```bash
export DART_SDK=~/Development/dart/dart-sdk/sdk

cp $DART_SDK/xcodebuild/ReleaseX64/vm_platform_strong.dill test/

# 将 hello.dart 编译成 kernel IR 文件 hello.dill
dart $DART_SDK/pkg/vm/bin/gen_kernel.dart --platform test/vm_platform_strong.dill -o test/hello.dill test/hello.dart

# hello.dill 可以由 dart 直接运行
dart test/hello.dill

# 反编译 hello.dill
dart $DART_SDK/pkg/vm/bin/dump_kernel.dart test/hello.dill test/hello.kernel.txt

# 反编译 vm_platform_strong.dill
dart $DART_SDK/pkg/vm/bin/dump_kernel.dart test/vm_platform_strong.dill test/vm_platform_strong.kernel.txt
```
